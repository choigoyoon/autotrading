import pandas as pd
import numpy as np

# 가상의 데이터프레임 생성
data = {
    'start_date': ['2023-01-01', '2023-01-05', '2023-01-10', pd.NaT, 'not_a_date'],
    'end_date': ['2023-01-11', '2023-01-12', '2023-01-15', '2023-01-20', '2023-01-25'],
    'value': [10, 20, 15, 30, 25],
    'condition1': [True, False, True, True, False],
    'condition2': [True, True, False, True, False]
}
df = pd.DataFrame(data)

# 10번째 줄 오류 수정: pd.to_datetime으로 타입을 명확히 하고 .dt 접근자 사용
# NaT나 잘못된 문자열이 있어도 errors='coerce'로 처리하여 NaT로 변환
df['duration_days'] = (pd.to_datetime(df['end_date'], errors='coerce') - pd.to_datetime(df['start_date'], errors='coerce')).dt.days

print("계산된 기간 (일):")
print(df['duration_days'])


# ... 중간 코드 (가상)
# ...
# ...
# ...
# ...
# ...
# ...
# ...
# ...
# ...
# ...
# ...
# ...
# ...
# ...
# ...
# ...
# ...
# ...
# ...
# ...
# ...
# 44번째 줄 오류 수정: pyright의 잘못된 경고를 무시하기 위해 # type: ignore 추가
filtered_df = df[(df['condition1']) & (df['condition2'])] # type: ignore

print("\n필터링된 데이터프레임:")
print(filtered_df) 